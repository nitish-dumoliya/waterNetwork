Water Network: 1
Results smooth approximation 1 of Hazen--Williams headloss constraint using absolute error

*******************************************************************************
wdnmodel.mod

-------------------------------- Solving with gurobi --------------------------
Gurobi 12.0.3: Set parameter LogToConsole to value 1
  tech:outlev = 1
  tech:outlev_mp = 1
Set parameter Presolve to value 1
  pre:solve = 1
Set parameter Aggregate to value 1
  pre:aggregate = 1
Set parameter TimeLimit to value 600
  lim:time = 600
Set parameter NumericFocus to value 1
  alg:numericfocus = 1
Set parameter OBBT to value 0
  mip:obbt = 0
Set parameter ScaleFlag to value 1
  pre:scale = 1
Set parameter Method to value 2
  alg:method = 2
Set parameter NodeMethod to value 1
  mip:nodemethod = 1
Set parameter NonConvex to value 2
  qp:nonconvex = 2
Set parameter MIPFocus to value 1
  mip:focus = 1
Set parameter NLPHeur to value 1
  alg:nlpheur = 1
Set parameter VarBranch to value 0
  mip:varbranch = 0
Set parameter MIPGapAbs to value 1e-05
  mip:gapabs = 1.0000000000000001e-05
Set parameter MIPGap to value 1e-06
  mip:gap = 9.9999999999999995e-07
Set parameter FeasibilityTol to value 1e-05
  alg:feastol = 1.0000000000000001e-05
  cvt:pre:feastol = 1.0000000000000001e-05
  cvt:pre:feastolrel = 9.9999999999999995e-07
  sol:chk:feastol = 1.0000000000000001e-05
  sol:chk:feastolrel = 9.9999999999999995e-07

AMPL MP initial flat model has 83 variables (0 integer, 0 binary);
Objectives: 1 linear; 
Constraints:  13 linear; 21 quadratic;
Algebraic expressions:  7 powconstexp;

AMPL MP final model has 111 variables (0 integer, 0 binary);
Objectives: 1 linear; 
Constraints:  20 linear; 21 quadratic;
Algebraic expressions:  7 powconstexp;


Set parameter InfUnbdInfo to value 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Debian GNU/Linux 12 (bookworm)")

CPU model: INTEL(R) XEON(R) GOLD 6530, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 32 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  600
FeasibilityTol  1e-05
MIPGap  1e-06
MIPGapAbs  1e-05
Method  2
ScaleFlag  1
MIPFocus  1
NodeMethod  1
OBBT  0
VarBranch  0
InfUnbdInfo  1
NonConvex  2
NumericFocus  1
Presolve  1

Optimize a model with 20 rows, 111 columns and 103 nonzeros
Model fingerprint: 0xcdf5f345
Model has 7 general nonlinear constraints (280 nonlinear terms)
Variable types: 111 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+00]
  Objective range  [2e+00, 2e+01]
  Bounds range     [2e-11, 5e+04]
  RHS range        [4e-02, 3e+03]
Presolve model has 7 nlconstr
Added 161 variables to disaggregate expressions.
Presolve removed 1 rows and 22 columns
Presolve time: 0.00s
Presolved: 467 rows, 258 columns, 1071 nonzeros
Presolved model has 84 bilinear constraint(s)
Presolved model has 7 nonlinear constraint(s)

Solving non-convex MINLP

Variable types: 258 continuous, 0 integer (0 binary)
Root barrier log...

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 3.083e+03
 Factor NZ  : 4.403e+03
 Factor Ops : 8.262e+04 (less than 1 second per iteration)
 Threads    : 1

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.13368961e+06 -1.95990066e+05  1.35e+04 0.00e+00  6.49e+03     1s
   1   2.50794026e+05 -5.23820042e+04  2.64e+03 4.44e-15  1.27e+03     1s
   2   1.07780443e+05  1.60063082e+04  7.25e+02 5.33e-15  3.43e+02     1s
   3   7.47532980e+04  3.09478340e+04  3.32e+02 4.97e-14  1.63e+02     1s
   4   7.14250979e+04  3.32953962e+04  2.95e+02 7.82e-14  1.42e+02     1s
   5   5.61630630e+04  3.92513486e+04  1.23e+02 7.11e-15  6.45e+01     1s
   6   5.62282773e+04  4.50862931e+04  9.07e+01 4.26e-14  5.03e+01     1s
   7   5.54544136e+04  4.86957076e+04  7.95e+01 3.20e-14  4.06e+01     1s
   8   5.31695398e+04  5.13728315e+04  5.27e+01 3.26e-14  2.55e+01     1s
   9   5.36133006e+04  5.21080478e+04  4.57e+01 2.84e-14  2.30e+01     1s
  10   5.53007473e+04  5.22315080e+04  4.37e+00 1.14e-13  6.85e+00     1s
  11   5.47849970e+04  5.43471142e+04  6.66e-01 5.68e-13  1.05e+00     1s
  12   5.45867287e+04  5.44250020e+04  2.56e-01 2.84e-13  3.81e-01     1s
  13   5.44641968e+04  5.44537265e+04  7.03e-03 5.68e-14  1.99e-02     1s
  14   5.44604294e+04  5.44594140e+04  1.29e-03 6.82e-13  2.18e-03     1s
  15   5.44596303e+04  5.44595585e+04  1.01e-04 9.66e-13  1.58e-04     1s
  16   5.44596101e+04  5.44595598e+04  7.14e-05 7.38e-13  1.11e-04     1s
  17   5.44595976e+04  5.44595607e+04  5.30e-05 1.53e-11  8.70e-05     1s
  18   5.44595881e+04  5.44595995e+04  3.95e-05 1.19e-12  6.68e-05     1s
  19   5.44596013e+04  5.44596044e+04  2.90e-05 7.39e-13  6.63e-05     1s
  20   5.44596329e+04  5.44596154e+04  1.33e-05 6.82e-13  5.77e-05     1s
  21   5.44596328e+04  5.44596306e+04  9.14e-06 1.26e-11  2.87e-05     1s
  22   5.44596369e+04  5.44596353e+04  7.66e-06 5.52e-12  2.72e-05     1s
  23   5.44596357e+04  5.44596356e+04  9.06e-07 3.30e-12  2.38e-06     1s
  24   5.44596357e+04  5.44596356e+04  3.51e-07 2.78e-12  9.87e-07     1s
  25   5.44596356e+04  5.44596356e+04  3.50e-08 4.17e-12  1.49e-07     1s
  26   5.44596356e+04  5.44596356e+04  8.21e-09 7.39e-13  2.60e-08     1s
  27   5.44596356e+04  5.44596356e+04  2.93e-08 8.85e-13  1.19e-08     1s
  28   5.44596356e+04  5.44596356e+04  4.42e-09 6.24e-13  6.63e-10     1s

Barrier solved model in 28 iterations and 0.86 seconds (0.02 work units)
Optimal objective 5.44596356e+04


Root relaxation: objective 5.445960e+04, 46 iterations, 0.20 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 54459.6004    0   19          - 54459.6004      -     -    0s
     0     0 54615.0198    0   18          - 54615.0198      -     -    0s
     0     0 54623.7590    0   18          - 54623.7590      -     -    0s
     0     0 54623.7590    0   18          - 54623.7590      -     -    1s
H    0     0                    135248.34319 54623.7590  59.6%     -    1s
H    0     0                    134646.09010 54623.7590  59.4%     -    1s
     0     2 54623.7590    0   18 134646.090 54623.7590  59.4%     -    2s
H   39    37                    123884.39361 99234.0808  19.9%  28.2    2s
  3869  2862 123854.107   68    1 123884.394 123765.988  0.10%   1.8    5s
 23952  5208 123830.368   43    4 123884.394 123807.973  0.06%   1.3   10s
 70825  4446 123843.808   66    2 123884.394 123807.973  0.06%   0.5   15s
 152705  7497 infeasible   70      123884.394 123807.973  0.06%   0.3   20s
 235874 10190 infeasible   91      123884.394 123807.973  0.06%   0.3   25s
 305075 13108 infeasible   83      123884.394 123807.973  0.06%   0.2   30s
 384889 16185 123845.342   73    3 123884.394 123807.973  0.06%   0.2   35s
 469326 19916 123846.633   84    3 123884.394 123807.973  0.06%   0.2   40s
 554857 22245 infeasible   89      123884.394 123807.973  0.06%   0.2   45s
 631099 23575 infeasible   91      123884.394 123807.973  0.06%   0.1   50s
 711499 25448 infeasible   89      123884.394 123807.973  0.06%   0.1   55s
 788615 26343 123845.572   88    2 123884.394 123807.973  0.06%   0.1   60s
 859517 27761 123845.585   77    2 123884.394 123807.973  0.06%   0.1   65s
 931386 28583 123846.410   70    2 123884.394 123807.973  0.06%   0.1   70s
 997809 29699 123845.615   81    3 123884.394 123807.973  0.06%   0.1   75s
 1069335 30809 123845.678   93    2 123884.394 123807.973  0.06%   0.1   80s
 1141578 31660 123845.662   87    2 123884.394 123807.973  0.06%   0.1   85s
 1208859 32813 infeasible   95      123884.394 123807.973  0.06%   0.1   90s
 1280879 33656 123845.734   96    2 123884.394 123807.973  0.06%   0.1   95s
 1347104 34665 123845.708   81    2 123884.394 123807.973  0.06%   0.1  100s
 1418776 35532 123845.726   85    3 123884.394 123807.973  0.06%   0.1  105s
 1490465 35951 infeasible   96      123884.394 123807.973  0.06%   0.1  110s
 1557541 36915 infeasible   76      123884.394 123807.973  0.06%   0.1  115s
 1624615 37952 infeasible   94      123884.394 123807.973  0.06%   0.1  120s
 1692228 38001 123845.791   93    2 123884.394 123807.973  0.06%   0.1  125s
 1754697 38333 123847.295   99    6 123884.394 123807.973  0.06%   0.1  130s
 1812266 38927 infeasible   89      123884.394 123807.973  0.06%   0.1  135s
 1874714 39875 123846.382   94    1 123884.394 123807.973  0.06%   0.1  140s
 1942167 40761 infeasible   91      123884.394 123807.973  0.06%   0.1  145s
 2009821 41649 123845.874   90    2 123884.394 123807.973  0.06%   0.1  150s
 2077251 42279 123845.880   89    2 123884.394 123807.973  0.06%   0.1  155s
 2139682 42713 123845.968   92    3 123884.394 123807.973  0.06%   0.1  160s
 2202474 43073 infeasible   80      123884.394 123807.973  0.06%   0.1  165s
 2265249 43478 infeasible   86      123884.394 123807.973  0.06%   0.1  170s
 2327957 44491 infeasible   93      123884.394 123807.973  0.06%   0.1  175s
 2395229 45321 123845.965   87    2 123884.394 123807.973  0.06%   0.1  180s
 2462967 46287 infeasible   90      123884.394 123807.973  0.06%   0.1  185s
 2530230 47084 123846.129   80    4 123884.394 123807.973  0.06%   0.1  190s
 2592410 48046 infeasible   87      123884.394 123807.973  0.06%   0.1  195s
 2654614 48553 123846.013   96    2 123884.394 123807.973  0.06%   0.1  200s
 2731349 49477 123846.005   95    2 123884.394 123807.973  0.06%   0.1  205s
 2808609 49873 123846.026   83    2 123884.394 123807.973  0.06%   0.1  210s
 2876106 50534 123846.038   96    2 123884.394 123807.973  0.06%   0.1  215s
 2948105 51465 infeasible   97      123884.394 123807.973  0.06%   0.1  220s
 3015846 52003 123846.090   99    2 123884.394 123807.973  0.06%   0.1  225s
 3078906 52457 123846.095   96    3 123884.394 123807.973  0.06%   0.1  230s
 3141779 52839 123847.552   90    2 123884.394 123807.973  0.06%   0.1  235s
 3199500 53524 infeasible   93      123884.394 123807.973  0.06%   0.1  240s
 3262085 54310 123846.111   94    2 123884.394 123807.973  0.06%   0.1  245s
 3325588 54762 123846.299   93    2 123884.394 123807.973  0.06%   0.1  250s
 3383357 55543 123846.151   82    2 123884.394 123807.973  0.06%   0.1  255s
 3445806 56436 123846.153   83    3 123884.394 123807.973  0.06%   0.1  260s
 3513053 57316 123847.467   90    2 123884.394 123807.973  0.06%   0.1  265s
 3570722 58061 infeasible  105      123884.394 123807.973  0.06%   0.1  270s
 3628387 58682 123846.203   88    3 123884.394 123807.973  0.06%   0.1  275s
 3695980 59076 123846.238   98    2 123884.394 123807.973  0.06%   0.1  280s
 3758136 59747 infeasible   95      123884.394 123807.973  0.06%   0.1  285s
 3815648 60375 infeasible   85      123884.394 123807.973  0.06%   0.1  290s
 3872982 61410 infeasible   97      123884.394 123807.973  0.06%   0.1  295s
 3930223 61480 infeasible   93      123884.394 123807.973  0.06%   0.1  300s
 3997288 62088 123847.389   97    1 123884.394 123807.973  0.06%   0.1  305s
 4054569 62483 infeasible   94      123884.394 123807.973  0.06%   0.1  310s
 4116220 63310 infeasible   89      123884.394 123807.973  0.06%   0.1  315s
 4173187 64395 123846.568   72    3 123884.394 123807.973  0.06%   0.1  320s
 4229655 65771 infeasible   88      123884.394 123807.973  0.06%   0.1  325s
 4281997 66416 123846.679   78    1 123884.394 123807.973  0.06%   0.1  330s
 4343771 67205 infeasible   97      123884.394 123807.973  0.06%   0.1  335s
 4396143 67965 123846.373   78    2 123884.394 123807.973  0.06%   0.1  340s
 4453198 68827 123846.418   90    2 123884.394 123807.973  0.06%   0.1  345s
 4509961 70168 123846.401   82    2 123884.394 123807.973  0.06%   0.1  350s
 4566522 70940 123846.435   86    2 123884.394 123807.973  0.06%   0.1  355s
 4623104 72156 123846.446   91    2 123884.394 123807.973  0.06%   0.1  360s
 4680460 73056 123846.454   84    2 123884.394 123807.973  0.06%   0.1  365s
 4746713 74143 infeasible   87      123884.394 123807.973  0.06%   0.1  370s
 4808799 75238 123853.728  103    2 123884.394 123807.973  0.06%   0.1  375s
 4870301 76250 123846.491   90    2 123884.394 123807.973  0.06%   0.1  380s
 4926200 78269 123846.512   83    2 123884.394 123807.973  0.06%   0.1  385s
 4993225 79199 infeasible   89      123884.394 123807.973  0.06%   0.1  390s
 5045222 79887 123848.270   94    2 123884.394 123807.973  0.06%   0.1  395s
 5107051 81131 123846.530   87    1 123884.394 123807.973  0.06%   0.1  400s
 5168689 82079 123846.528   80    2 123884.394 123807.973  0.06%   0.1  405s
 5229634 83519 123846.529   82    3 123884.394 123807.973  0.06%   0.1  410s
H5283213 84725                    123884.39358 123807.973  0.06%   0.1  414s
H5286129 84725                    123884.39348 123807.973  0.06%   0.1  414s
 5286443 84743 123846.550   89    2 123884.393 123807.973  0.06%   0.1  415s
H5295284 85018                    123884.39336 123807.973  0.06%   0.1  416s
 5335207 85936 123846.552   87    2 123884.393 123807.973  0.06%   0.1  420s
 5389689 86872 infeasible   91      123884.393 123807.973  0.06%   0.1  425s
H5425536 87602                    123884.39327 123807.973  0.06%   0.1  428s
 5444245 88112 infeasible  101      123884.393 123807.973  0.06%   0.1  430s
H5452197 88191                    123884.39318 123807.973  0.06%   0.1  430s
 5506646 88699 123846.590   97    2 123884.393 123807.973  0.06%   0.1  435s
H5522119 88716                    123884.39285 123807.973  0.06%   0.1  436s
H5523716 88716                    123884.38676 123807.973  0.06%   0.1  436s
 5559306 89316 infeasible   89      123884.387 123807.973  0.06%   0.1  440s
 5621915 89945 123846.588   91    3 123884.387 123807.973  0.06%   0.1  445s
 5684337 90544 123846.597   85    2 123884.387 123807.973  0.06%   0.1  450s
 5736929 91200 123846.630   93    2 123884.387 123807.973  0.06%   0.1  455s
 5798083 92031 123846.637   89    2 123884.387 123807.973  0.06%   0.1  460s
 5860492 92934 123846.657   86    2 123884.387 123807.973  0.06%   0.1  465s
 5913272 93586 infeasible   89      123884.387 123807.973  0.06%   0.1  470s
 5975060 94430 123846.638   90    2 123884.387 123807.973  0.06%   0.1  475s
 6037450 95268 123847.050   93    2 123884.387 123807.973  0.06%   0.1  480s
 6104690 96283 infeasible   88      123884.387 123807.973  0.06%   0.1  485s
 6185966 97710 123848.008   97    1 123884.387 123807.973  0.06%   0.1  490s
 6257364 98727 infeasible   95      123884.387 123807.973  0.06%   0.1  495s
 6324238 99370 infeasible   92      123884.387 123807.973  0.06%   0.1  500s
 6386495 99688 123846.788   86    3 123884.387 123807.973  0.06%   0.1  505s
 6444258 100315 infeasible  110      123884.387 123807.973  0.06%   0.1  510s
 6505991 100892 123846.789   97    2 123884.387 123807.973  0.06%   0.1  515s
 6572926 102041 infeasible  109      123884.387 123807.973  0.06%   0.1  520s
 6639555 103179 123847.456   77    4 123884.387 123807.973  0.06%   0.1  525s
 6706310 103888 123846.743   96    3 123884.387 123807.973  0.06%   0.1  530s
 6782062 105218 123847.542   97    3 123884.387 123807.973  0.06%   0.1  535s
 6848427 106562 123846.751   88    2 123884.387 123807.973  0.06%   0.1  540s
 6909787 107276 infeasible   84      123884.387 123807.973  0.06%   0.1  545s
 6961485 108095 123846.896   91    1 123884.387 123807.973  0.06%   0.1  550s
 7022757 108816 infeasible   96      123884.387 123807.973  0.06%   0.1  555s
 7079537 109905 123846.795   83    2 123884.387 123807.973  0.06%   0.1  560s
 7136757 110648 infeasible   90      123884.387 123807.973  0.06%   0.1  565s
 7193297 111058 infeasible   85      123884.387 123807.973  0.06%   0.1  570s
 7249066 112295 infeasible   85      123884.387 123807.973  0.06%   0.1  575s
 7306220 112960 infeasible   96      123884.387 123807.973  0.06%   0.1  580s
 7377783 113948 123846.941   93    3 123884.387 123807.973  0.06%   0.1  585s
 7439475 114690 infeasible   89      123884.387 123807.973  0.06%   0.1  590s
 7500973 115067 123846.829   83    2 123884.387 123807.973  0.06%   0.1  595s
 7557974 115691 123847.081   97    2 123884.387 123807.973  0.06%   0.1  600s

Cutting planes:
  RLT: 10

Explored 7560217 nodes (397035 simplex iterations) in 600.05 seconds (36.24 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: 123884 123884 123884 ... 135248

Time limit reached
Best objective 1.238843867615e+05, best bound 1.238079729094e+05, gap 0.0617%
Gurobi 12.0.3: time limit, feasible solution; objective 123884.3868
397035 simplex iterations
53 barrier iterations
7.56022e+06 branching nodes
absmipgap=76.4139, relmipgap=0.000616816
eps :=
1 2   4.26278e-06
2 3   1.2431e-05
2 6   6.97685e-06
3 4   6.57014e-06
4 5   5.81329e-06
6 7   5.85767e-06
7 5   5.27819e-06
;

*******************************************************************************

Constraints violation:


Sum of constraints violation: 2.161857855276228e-05
*******************************************************************************

*******************************************************************************

Absolute and relative violations between original and approximation constraint 2:

+-----------------+--------------+--------------------------+------------------------+----------------------+----------------------+
| Constraint ID   |   flow value |   Original Con Violation |   Approx Con Violation |   Absolute Violation |   Relative Violation |
+=================+==============+==========================+========================+======================+======================+
| 1,2             |      0.42043 |                 0        |              -0        |               -0     |                   -0 |
+-----------------+--------------+--------------------------+------------------------+----------------------+----------------------+
| 2,3             |      0.29233 |                 0        |               0        |               -0     |                   -0 |
+-----------------+--------------+--------------------------+------------------------+----------------------+----------------------+
| 2,6             |      0.1281  |                -0        |              -1e-08    |               -1e-08 |                   -0 |
+-----------------+--------------+--------------------------+------------------------+----------------------+----------------------+
| 3,4             |      0.24889 |                -0        |              -0        |               -0     |                   -0 |
+-----------------+--------------+--------------------------+------------------------+----------------------+----------------------+
| 4,5             |      0.2086  |                 0        |              -0        |               -0     |                   -0 |
+-----------------+--------------+--------------------------+------------------------+----------------------+----------------------+
| 6,7             |      0.08032 |                -9.95e-06 |              -9.96e-06 |               -2e-08 |                   -0 |
+-----------------+--------------+--------------------------+------------------------+----------------------+----------------------+
| 7,5             |      0       |                 0        |               0        |                0     |                    0 |
+-----------------+--------------+--------------------------+------------------------+----------------------+----------------------+

Sum of violation of original headloss constraint: 9.948060807785097e-06
Sum of violation of approx headloss constraint: 9.978243326047576e-06

Con2 sum of absolute violation between original function and approximate function: 3.3051942960327096e-08
Con2 sum of relative violation between original function and approximate function: 4.971230849453986e-09
*******************************************************************************

Total cost using gurobi: 123884.3867615017
gurobi solve time: 600.29 seconds
*******************************************************************************

